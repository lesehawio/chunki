<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>English Chunk Cycle Pro</title>
<link rel="icon" type="image/png" href="https://uploadkon.ir/uploads/855814_261000016643-removebg-preview.png">

<style>
/* ================= ROOT THEMES ================= */
:root{
  --green:#91c300;
  --red:#ff4b5c;
  --dark-bg:#050711;
  --dark-card:#111522;
  --dark-gray:#2d334a;
  --light-bg:#f5f5f5;
  --light-card:#ffffff;
  --light-gray:#e0e0e0;
  --text-dark:#ffffff;
  --text-light:#000000;
  --shadow:rgba(0,0,0,0.55);
}

*{
  box-sizing:border-box;
  font-family:'Segoe UI',sans-serif;
}

body.dark{
  background:radial-gradient(circle at top,#1b2540,#050711);
  color:var(--text-dark);
}
body.light{
  background:radial-gradient(circle at top,#ffffff,#dcdcdc);
  color:var(--text-light);
}

body{
  margin:0;
  display:flex;
  justify-content:center;
  align-items:center;
  min-height:100vh;
  padding:20px;
  transition:background 0.5s ease, color 0.5s ease;
}

/* ================= TOP BAR ================= */
.top-bar{
  position:absolute;
  top:0;
  left:0;
  width:100%;
  height:90px;
  display:flex;
  justify-content:center;
  align-items:flex-start;
  padding-top:10px;
  z-index:20;
}

/* ÿØ⁄©ŸÖŸáŸî ÿ™ŸÖ ÿØÿ± ⁄ØŸàÿ¥ŸáŸî ÿ®ÿßŸÑÿß ÿ≥ŸÖÿ™ ⁄ÜŸæ */
.theme-btn{
  position:absolute;
  left:15px;
  top:15px;
  width:42px;
  height:42px;
  border:none;
  border-radius:50%;
  cursor:pointer;
  font-size:20px;
  background:rgba(255,255,255,0.15);
  backdrop-filter:blur(6px);
  color:#fff;
  box-shadow:0 4px 12px rgba(0,0,0,0.3);
  transition:0.3s;
}
body.light .theme-btn{
  background:rgba(0,0,0,0.15);
  color:#000;
}
.theme-btn:hover{
  transform:scale(1.12);
}

/* ================= LOGO ================= */
.logo{
  position:absolute;
  top:15px;
  right:15px;
  cursor:pointer;
  z-index:30;
}
.logo img{
  width:130px;
  filter:drop-shadow(0 10px 26px rgba(0,255,118,0.55));
  animation:float 3.5s ease-in-out infinite;
  transition:transform 0.35s ease, filter 0.35s ease;
}
.logo img:hover{
  transform:translateY(-6px) scale(1.06);
  filter:drop-shadow(0 14px 32px rgba(0,255,118,0.85));
}
.logo img:active{
  transform:scale(0.9);
}
@keyframes float{
  0%{transform:translateY(0);}
  50%{transform:translateY(-8px);}
  100%{transform:translateY(0);}
}

/* ================= CONTAINER ================= */
.container{
  width:100%;
  max-width:520px;
  background:var(--dark-card);
  border-radius:22px;
  padding:110px 30px 30px 30px;
  box-shadow:0 18px 45px var(--shadow);
  position:relative;
  overflow:hidden;
  transition:background 0.5s ease, box-shadow 0.5s ease, transform 0.3s ease;
}
body.light .container{
  background:var(--light-card);
}
.container:hover{
  transform:translateY(-3px);
}

/* ================= UI ================= */
h2{
  text-align:center;
  margin-bottom:8px;
  font-weight:650;
}

.progress-container{
  width:100%;
  height:10px;
  background:rgba(255,255,255,0.08);
  border-radius:999px;
  overflow:hidden;
  margin-bottom:15px;
}
.progress-bar{
  height:100%;
  width:0%;
  background:linear-gradient(90deg,#91c300,#00ffb3);
  transition:width 0.4s ease;
}

.stage{
  text-align:center;
  opacity:.8;
  margin-bottom:12px;
  font-size:14px;
}

.word{
  text-align:center;
  font-size:26px;
  letter-spacing:3px;
  margin:12px 0;
  color:var(--green);
  text-shadow:0 0 10px rgba(0,255,118,0.6);
}

/* ================= ANSWER & LETTERS ================= */
.answer-box{
  min-height:60px;
  border:2px dashed rgba(255,255,255,0.12);
  border-radius:16px;
  display:flex;
  flex-wrap:wrap;
  justify-content:center;
  align-items:center;
  gap:10px;
  margin:18px 0;
  padding:12px;
  background:rgba(0,0,0,0.25);
  backdrop-filter:blur(10px);
}
body.light .answer-box{
  border-color:rgba(0,0,0,0.12);
  background:rgba(255,255,255,0.6);
}

.letters{
  display:flex;
  flex-wrap:wrap;
  justify-content:center;
  gap:12px;
  margin-bottom:12px;
}

.letter{
  background:var(--dark-gray);
  padding:12px 16px;
  border-radius:14px;
  cursor:pointer;
  user-select:none;
  transition:all 0.25s ease;
  font-size:18px;
  box-shadow:0 4px 14px rgba(0,0,0,0.4);
}
body.light .letter{
  background:var(--light-gray);
}
.letter:hover{
  transform:scale(1.12) translateY(-2px);
  background:var(--green);
  color:#000;
}

/* ================= NEXT BUTTON ================= */
.next-btn{
  width:100%;
  margin-top:12px;
  padding:14px;
  border:none;
  border-radius:14px;
  font-size:16px;
  font-weight:600;
  cursor:pointer;
  background:#444;
  color:#aaa;
  cursor:not-allowed;
  transition:0.3s;
}
.next-btn.active{
  background:linear-gradient(90deg,#91c300,#00ffb3);
  color:#000;
  cursor:pointer;
}

/* ================= RESULT MODAL ================= */
.result-overlay{
  position:fixed;
  inset:0;
  display:flex;
  justify-content:center;
  align-items:center;
  background:rgba(0,0,0,0.45);
  backdrop-filter:blur(4px);
  opacity:0;
  pointer-events:none;
  transition:opacity 0.3s ease;
  z-index:50;
}
.result-overlay.show{
  opacity:1;
  pointer-events:auto;
}

.result-card{
  width:90%;
  max-width:360px;
  border-radius:20px;
  padding:22px;
  background:rgba(15,18,30,0.92);
  color:#fff;
  box-shadow:0 18px 40px rgba(0,0,0,0.7);
  transform:scale(0.85) translateY(20px);
  opacity:0;
  transition:transform 0.35s ease, opacity 0.35s ease;
}
body.light .result-card{
  background:rgba(255,255,255,0.96);
  color:#000;
}
.result-overlay.show .result-card{
  transform:scale(1) translateY(0);
  opacity:1;
}

.result-icon{
  font-size:40px;
  text-align:center;
  margin-bottom:10px;
}
.result-title{
  text-align:center;
  font-weight:700;
  margin-bottom:10px;
}
.result-detail{
  font-size:15px;
  line-height:1.7;
  margin-top:6px;
  text-align:center;
}
.result-score{
  margin-top:10px;
  font-size:15px;
  font-weight:600;
  text-align:center;
  color:var(--green);
}

.modal-next{
  margin-top:18px;
  width:100%;
  padding:12px;
  border:none;
  border-radius:12px;
  background:linear-gradient(90deg,#91c300,#00ffb3);
  font-size:16px;
  font-weight:600;
  cursor:pointer;
  color:#000;
}

/* ================= RESPONSIVE ================= */
@media(max-width:500px){
  .container{padding:120px 20px 25px 20px;}
  .word{font-size:22px;}
  .letter{padding:10px 14px;font-size:16px;}
}
</style>
</head>

<body class="dark">

<!-- TOP BAR -->
<div class="top-bar">
  <button class="theme-btn" id="themeBtn">üåô</button>

  <div class="logo" id="logoToggle">
    <img src="https://uploadkon.ir/uploads/855814_261000016643-removebg-preview.png">
  </div>
</div>

<div class="container">

  <h2>English Learning Game</h2>

  <div class="progress-container">
    <div class="progress-bar" id="progressBar"></div>
  </div>

  <div class="stage" id="stage"></div>
  <div class="word" id="targetWord"></div>

  <div class="answer-box" id="answerBox"></div>
  <div class="letters" id="lettersBox"></div>

  <button class="next-btn" id="nextBtn">Continue</button>

  <div class="info" id="info"></div>
  <div class="score">Score: <span id="score">0</span></div>

</div>

<!-- RESULT MODAL -->
<div class="result-overlay" id="resultOverlay">
  <div class="result-card">
    <div class="result-icon" id="resultIcon">‚ùå</div>
    <div class="result-title" id="resultTitle">ŸÜÿ™€åÿ¨Ÿá</div>
    <div class="result-detail" id="resultDetail"></div>
    <div class="result-score" id="resultScore"></div>
    <button class="modal-next" id="modalNext">Next</button>
  </div>
</div>

<script>
/* ================= DATA ================= */
const data = {
  pairs: [
{
noun: {w: "appointment", fa: "ŸÇÿ±ÿßÿ± ŸÖŸÑÿßŸÇÿßÿ™", pr: "ÿßŸæŸà€åŸÜÿ™ŸÖŸÜÿ™"},
verb: {w: "schedule", fa: "ÿ™ŸÜÿ∏€åŸÖ ⁄©ÿ±ÿØŸÜ", pr: "ÿ≥⁄©ÿ¨ŸàŸÑ"},
chunk: "schedule an appointment",
chunkFa: "ÿ™ŸÜÿ∏€åŸÖ ŸÇÿ±ÿßÿ± ŸÖŸÑÿßŸÇÿßÿ™"
},

{
noun: {w: "attendance", fa: "ÿ≠ÿ∂Ÿàÿ± Ÿà ÿ∫€åÿßÿ®", pr: "ÿßÿ™ŸÜÿØŸÜÿ≥"},
verb: {w: "take", fa: "⁄Øÿ±ŸÅÿ™ŸÜ", pr: "ÿ™Ÿê€å⁄©"},
chunk: "take attendance",
chunkFa: "ÿ≠ÿ∂Ÿàÿ± Ÿà ÿ∫€åÿßÿ® ⁄Øÿ±ŸÅÿ™ŸÜ"
},

{
noun: {w: "feedback", fa: "ÿ®ÿßÿ≤ÿÆŸàÿ±ÿØ", pr: "ŸÅ€åÿØÿ®⁄©"},
verb: {w: "give", fa: "ÿØÿßÿØŸÜ", pr: "⁄Ø€åŸà"},
chunk: "give feedback",
chunkFa: "ÿ®ÿßÿ≤ÿÆŸàÿ±ÿØ ÿØÿßÿØŸÜ"
},

{
noun: {w: "meeting", fa: "ÿ¨ŸÑÿ≥Ÿá", pr: "ŸÖ€åÿ™€åŸÜ⁄Ø"},
verb: {w: "attend", fa: "ÿ¥ÿ±⁄©ÿ™ ⁄©ÿ±ÿØŸÜ", pr: "ÿßÿ™ŸÜÿØ"},
chunk: "attend a meeting",
chunkFa: "ÿØÿ± ÿ¨ŸÑÿ≥Ÿá ÿ¥ÿ±⁄©ÿ™ ⁄©ÿ±ÿØŸÜ"
},

{
noun: {w: "task", fa: "Ÿàÿ∏€åŸÅŸá", pr: "ÿ™ÿ≥⁄©"},
verb: {w: "assign", fa: "Ÿàÿß⁄Øÿ∞ÿßÿ± ⁄©ÿ±ÿØŸÜ", pr: "ÿßÿ≥ÿß€åŸÜ"},
chunk: "assign a task",
chunkFa: "Ÿàÿß⁄Øÿ∞ÿßÿ±€å ⁄©ÿßÿ±"
},

{
noun: {w: "mistakes", fa: "ÿßÿ¥ÿ™ÿ®ÿßŸáÿßÿ™", pr: "ŸÖ€åÿ≥ÿ™€å⁄©ÿ≥"},
verb: {w: "fix", fa: "ÿØÿ±ÿ≥ÿ™ ⁄©ÿ±ÿØŸÜ", pr: "ŸÅ€å⁄©ÿ≥"},
chunk: "fix mistakes",
chunkFa: "ÿßÿµŸÑÿßÿ≠ ÿßÿ¥ÿ™ÿ®ÿßŸáÿßÿ™"
},

{
noun: {w: "proposal", fa: "Ÿæ€åÿ¥ŸÜŸáÿßÿØ", pr: "Ÿæÿ±ŸàŸæŸàÿ≤ÿßŸÑ"},
verb: {w: "submit", fa: "ÿßÿ±ÿ≥ÿßŸÑ ⁄©ÿ±ÿØŸÜ", pr: "ÿ≥ÿßÿ®ŸÖ€åÿ™"},
chunk: "submit a proposal",
chunkFa: "ÿßÿ±ÿ≥ÿßŸÑ Ÿæ€åÿ¥ŸÜŸáÿßÿØ"
},

{
noun: {w: "research", fa: "ÿ™ÿ≠ŸÇ€åŸÇ", pr: "ÿ±€åÿ≥ÿ±⁄Ü"},
verb: {w: "do", fa: "ÿßŸÜÿ¨ÿßŸÖ ÿØÿßÿØŸÜ", pr: "ÿØŸà"},
chunk: "do research",
chunkFa: "ÿ™ÿ≠ŸÇ€åŸÇ ⁄©ÿ±ÿØŸÜ"
},

{
noun: {w: "data", fa: "ÿØÿßÿØŸá", pr: "ÿØ€åÿ™ÿß"},
verb: {w: "analyze", fa: "ÿ™ÿ≠ŸÑ€åŸÑ ⁄©ÿ±ÿØŸÜ", pr: "ÿßŸÜÿßŸÑÿß€åÿ≤"},
chunk: "analyze data",
chunkFa: "ÿ™ÿ≠ŸÑ€åŸÑ ÿØÿßÿØŸá"
},

{
noun: {w: "essay", fa: "ŸÖŸÇÿßŸÑŸá", pr: "ÿßÿ≥Ÿê€å"},
verb: {w: "write", fa: "ŸÜŸàÿ¥ÿ™ŸÜ", pr: "ÿ±ÿß€åÿ™"},
chunk: "write an essay",
chunkFa: "ŸÜŸàÿ¥ÿ™ŸÜ ŸÖŸÇÿßŸÑŸá"
},

{
noun: {w: "vocabulary", fa: "ŸÑÿ∫ÿßÿ™", pr: "ŸàŸà⁄©ÿ®€åŸàŸÑÿ±€å"},
verb: {w: "learn", fa: "€åÿßÿØ ⁄Øÿ±ŸÅÿ™ŸÜ", pr: "ŸÑŸêÿ±ŸÜ"},
chunk: "learn vocabulary",
chunkFa: "€åÿßÿØ ⁄Øÿ±ŸÅÿ™ŸÜ ŸÑÿ∫ÿßÿ™"
},

{
noun: {w: "chapter", fa: "ŸÅÿµŸÑ", pr: "⁄ÜŸæÿ™ÿ±"},
verb: {w: "review", fa: "ŸÖÿ±Ÿàÿ± ⁄©ÿ±ÿØŸÜ", pr: "ÿ±€åŸà€åŸà"},
chunk: "review a chapter",
chunkFa: "ŸÖÿ±Ÿàÿ± €å⁄© ŸÅÿµŸÑ"
},

{
noun: {w: "exercises", fa: "ÿ™ŸÖÿ±€åŸÜ‚ÄåŸáÿß", pr: "ÿß⁄©ÿ≥ÿ±ÿ≥ÿß€åÿ≤ÿ≤"},
verb: {w: "do", fa: "ÿßŸÜÿ¨ÿßŸÖ ÿØÿßÿØŸÜ", pr: "ÿØŸà"},
chunk: "do exercises",
chunkFa: "ÿßŸÜÿ¨ÿßŸÖ ÿ™ŸÖÿ±€åŸÜ‚ÄåŸáÿß"
},

{
noun: {w: "notes", fa: "€åÿßÿØÿØÿßÿ¥ÿ™", pr: "ŸÜŸàÿ™ÿ≥"},
verb: {w: "take", fa: "ÿ®ÿ±ÿØÿßÿ¥ÿ™ŸÜ", pr: "ÿ™€å⁄©"},
chunk: "take notes",
chunkFa: "€åÿßÿØÿØÿßÿ¥ÿ™ ÿ®ÿ±ÿØÿßÿ±€å"
},

{
noun: {w: "performance", fa: "ÿπŸÖŸÑ⁄©ÿ±ÿØ", pr: "Ÿæÿ±ŸÅŸàÿ±ŸÖŸÜÿ≥"},
verb: {w: "evaluate", fa: "ÿßÿ±ÿ≤€åÿßÿ®€å ⁄©ÿ±ÿØŸÜ", pr: "ÿßŸêŸàŸÑ€åŸà€åÿ™"},
chunk: "evaluate performance",
chunkFa: "ÿßÿ±ÿ≤€åÿßÿ®€å ÿπŸÖŸÑ⁄©ÿ±ÿØ"
},

{
noun: {w: "topic", fa: "ŸÖŸàÿ∂Ÿàÿπ", pr: "ÿ™ÿßŸæ€å⁄©"},
verb: {w: "discuss", fa: "ÿ®ÿ≠ÿ´ ⁄©ÿ±ÿØŸÜ", pr: "ÿØ€åÿ≥⁄©ÿßÿ≥"},
chunk: "discuss a topic",
chunkFa: "ÿ®ÿ≠ÿ´ ÿØÿ±ÿ®ÿßÿ±Ÿá ŸÖŸàÿ∂Ÿàÿπ"
},

{
noun: {w: "concept", fa: "ŸÖŸÅŸáŸàŸÖ", pr: "⁄©ÿßŸÜÿ≥Ÿæÿ™"},
verb: {w: "explain", fa: "ÿ™Ÿàÿ∂€åÿ≠ ÿØÿßÿØŸÜ", pr: "ÿß⁄©ÿ≥ŸæŸÑ€åŸÜ"},
chunk: "explain a concept",
chunkFa: "ÿ™Ÿàÿ∂€åÿ≠ ŸÖŸÅŸáŸàŸÖ"
},

{
noun: {w: "questions", fa: "ÿ≥ŸàÿßŸÑÿßÿ™", pr: "⁄©Ÿàÿ¶ÿ≥⁄ÜŸÜÿ≤"},
verb: {w: "ask", fa: "Ÿæÿ±ÿ≥€åÿØŸÜ", pr: "ÿßÿ≥⁄©"},
chunk: "ask questions",
chunkFa: "ÿ≥ŸàÿßŸÑ Ÿæÿ±ÿ≥€åÿØŸÜ"
},

{
noun: {w: "office hours", fa: "ÿ≥ÿßÿπÿßÿ™ ŸÖÿ¥ÿßŸàÿ±Ÿá", pr: "ÿ¢ŸÅ€åÿ≥ ÿ¢Ÿàÿ±ÿ≤"},
verb: {w: "go to", fa: "ÿ±ŸÅÿ™ŸÜ ÿ®Ÿá", pr: "⁄ØŸà ÿ™Ÿà"},
chunk: "go to office hours",
chunkFa: "ÿ±ŸÅÿ™ŸÜ ÿ®Ÿá ÿ≥ÿßÿπÿßÿ™ ŸÖÿ¥ÿßŸàÿ±Ÿá"
},

{
noun: {w: "coursework", fa: "⁄©ÿßÿ±Ÿáÿß€å ÿØÿ±ÿ≥€å", pr: "⁄©Ÿàÿ±ÿ≥‚ÄåŸàÿ±⁄©"},
verb: {w: "turn in", fa: "ÿ™ÿ≠Ÿà€åŸÑ ÿØÿßÿØŸÜ", pr: "ÿ™ÿ±ŸÜ ÿß€åŸÜ"},
chunk: "turn in coursework",
chunkFa: "ÿ™ÿ≠Ÿà€åŸÑ ⁄©ÿßÿ± ÿØÿ±ÿ≥€å"
},

{
noun: {w: "instructions", fa: "ÿØÿ≥ÿ™Ÿàÿ±ÿßŸÑÿπŸÖŸÑ", pr: "ÿß€åŸÜÿ≥ÿ™ÿ±ÿß⁄©ÿ¥ŸÜÿ≤"},
verb: {w: "follow", fa: "ÿØŸÜÿ®ÿßŸÑ ⁄©ÿ±ÿØŸÜ", pr: "ŸÅÿßŸÑŸà"},
chunk: "follow instructions",
chunkFa: "ÿØŸÜÿ®ÿßŸÑ ⁄©ÿ±ÿØŸÜ ÿØÿ≥ÿ™Ÿàÿ±ÿßŸÑÿπŸÖŸÑ"
},

{
noun: {w: "exam", fa: "ÿßŸÖÿ™ÿ≠ÿßŸÜ", pr: "ÿß⁄Øÿ≤ŸéŸÖ"},
verb: {w: "take", fa: "ÿØÿßÿØŸÜ", pr: "ÿ™Ÿê€å⁄©"},
chunk: "take an exam",
chunkFa: "ÿßŸÖÿ™ÿ≠ÿßŸÜ ÿØÿßÿØŸÜ"
},

{
noun: {w: "study materials", fa: "ŸÖŸÜÿßÿ®ÿπ ŸÖÿ∑ÿßŸÑÿπŸá", pr: "ÿßÿ≥ÿ™ÿßÿØ€å ŸÖÿ™ÿ±€åÿßŸÑÿ≤"},
verb: {w: "prepare", fa: "ÿ¢ŸÖÿßÿØŸá ⁄©ÿ±ÿØŸÜ", pr: "Ÿæÿ±ŸæŸêÿ±"},
chunk: "prepare study materials",
chunkFa: "ÿ¢ŸÖÿßÿØŸá ⁄©ÿ±ÿØŸÜ ŸÖŸÜÿßÿ®ÿπ"
},

{
noun: {w: "group work", fa: "⁄©ÿßÿ± ⁄Øÿ±ŸàŸá€å", pr: "⁄Øÿ±ŸàŸæ Ÿàÿ±⁄©"},
verb: {w: "work on", fa: "⁄©ÿßÿ± ⁄©ÿ±ÿØŸÜ ÿ±Ÿà€å", pr: "Ÿàÿ±⁄© ÿ¢ŸÜ"},
chunk: "work on group work",
chunkFa: "⁄©ÿßÿ± ÿ±Ÿà€å ⁄©ÿßÿ± ⁄Øÿ±ŸàŸá€å"
},

{
noun: {w: "quiz", fa: "⁄©Ÿàÿ¶€åÿ≤", pr: "⁄©Ÿà€åÿ≤"},
verb: {w: "take", fa: "ÿØÿßÿØŸÜ", pr: "ÿ™Ÿê€å⁄©"},
chunk: "take a quiz",
chunkFa: "ÿØÿßÿØŸÜ ⁄©Ÿàÿ¶€åÿ≤"
},

{
noun: {w: "project", fa: "Ÿæÿ±Ÿà⁄òŸá", pr: "Ÿæÿ±ÿßÿ¨⁄©ÿ™"},
verb: {w: "present", fa: "ÿßÿ±ÿßÿ¶Ÿá ÿØÿßÿØŸÜ", pr: "Ÿæÿ±ÿ≤ŸÜÿ™"},
chunk: "present a project",
chunkFa: "ÿßÿ±ÿßÿ¶Ÿá Ÿæÿ±Ÿà⁄òŸá"
},

{
noun: {w: "discussion", fa: "ÿ®ÿ≠ÿ´", pr: "ÿØ€åÿ≥⁄©ÿßÿ¥ŸÜ"},
verb: {w: "lead", fa: "ŸáÿØÿß€åÿ™ ⁄©ÿ±ÿØŸÜ", pr: "ŸÑ€åÿØ"},
chunk: "lead a discussion",
chunkFa: "ŸáÿØÿß€åÿ™ ÿ®ÿ≠ÿ´"
},

{
noun: {w: "notes", fa: "€åÿßÿØÿØÿßÿ¥ÿ™", pr: "ŸÜŸàÿ™ÿ≥"},
verb: {w: "write", fa: "ŸÜŸàÿ¥ÿ™ŸÜ", pr: "ÿ±ÿß€åÿ™"},
chunk: "write notes",
chunkFa: "ŸÜŸàÿ¥ÿ™ŸÜ €åÿßÿØÿØÿßÿ¥ÿ™"
},

{
noun: {w: "schedule", fa: "ÿ®ÿ±ŸÜÿßŸÖŸá ÿ≤ŸÖÿßŸÜ€å", pr: "ÿ≥⁄©ÿ¨ŸàŸÑ"},
verb: {w: "set", fa: "ÿ™ŸÜÿ∏€åŸÖ ⁄©ÿ±ÿØŸÜ", pr: "ÿ≥Ÿêÿ™"},
chunk: "set a schedule",
chunkFa: "ÿ™ŸÜÿ∏€åŸÖ ÿ®ÿ±ŸÜÿßŸÖŸá"
},

{
noun: {w: "workshop", fa: "⁄©ÿßÿ±⁄ØÿßŸá", pr: "Ÿàÿ±⁄©ÿ¥ÿßŸæ"},
verb: {w: "attend", fa: "ÿ¥ÿ±⁄©ÿ™ ⁄©ÿ±ÿØŸÜ", pr: "ÿßÿ™ŸÜÿØ"},
chunk: "attend a workshop",
chunkFa: "ÿ¥ÿ±⁄©ÿ™ ÿØÿ± ⁄©ÿßÿ±⁄ØÿßŸá"
},

{
noun: {w: "homework", fa: "ÿ™⁄©ŸÑ€åŸÅ", pr: "ŸáŸàŸÖ‚ÄåŸàÿ±⁄©"},
verb: {w: "check", fa: "ÿ®ÿ±ÿ±ÿ≥€å ⁄©ÿ±ÿØŸÜ", pr: "⁄Ü⁄©"},
chunk: "check homework",
chunkFa: "ÿ®ÿ±ÿ±ÿ≥€å ÿ™⁄©ŸÑ€åŸÅ"
},

{
noun: {w: "plan", fa: "ÿ®ÿ±ŸÜÿßŸÖŸá", pr: "ŸæŸÑŸÜ"},
verb: {w: "make", fa: "ÿ≥ÿßÿÆÿ™ŸÜ", pr: "ŸÖŸê€å⁄©"},
chunk: "make a plan",
chunkFa: "ÿ®ÿ±ŸÜÿßŸÖŸá‚Äåÿ±€åÿ≤€å ⁄©ÿ±ÿØŸÜ"
},

{
noun: {w: "notes", fa: "€åÿßÿØÿØÿßÿ¥ÿ™", pr: "ŸÜŸàÿ™ÿ≥"},
verb: {w: "review", fa: "ŸÖÿ±Ÿàÿ± ⁄©ÿ±ÿØŸÜ", pr: "ÿ±€åŸà€åŸà"},
chunk: "review notes",
chunkFa: "ŸÖÿ±Ÿàÿ± €åÿßÿØÿØÿßÿ¥ÿ™‚ÄåŸáÿß"
},

{
noun: {w: "tutorial", fa: "ÿ¨ŸÑÿ≥Ÿá ÿ¢ŸÖŸàÿ≤ÿ¥€å", pr: "ÿ™Ÿàÿ™Ÿàÿ±€åÿßŸÑ"},
verb: {w: "attend", fa: "ÿ¥ÿ±⁄©ÿ™ ⁄©ÿ±ÿØŸÜ", pr: "ÿßÿ™ŸÜÿØ"},
chunk: "attend a tutorial",
chunkFa: "ÿ¥ÿ±⁄©ÿ™ ÿØÿ± ÿ¨ŸÑÿ≥Ÿá ÿ¢ŸÖŸàÿ≤ÿ¥€å"
},

{
noun: {w: "essay", fa: "ŸÖŸÇÿßŸÑŸá", pr: "ÿßÿ≥Ÿê€å"},
verb: {w: "turn in", fa: "ÿ™ÿ≠Ÿà€åŸÑ ÿØÿßÿØŸÜ", pr: "ÿ™ÿ±ŸÜ ÿß€åŸÜ"},
chunk: "turn in an essay",
chunkFa: "ÿ™ÿ≠Ÿà€åŸÑ ŸÖŸÇÿßŸÑŸá"
},

{
noun: {w: "clarification", fa: "ÿ¥ŸÅÿßŸÅ‚Äåÿ≥ÿßÿ≤€å", pr: "⁄©ŸÑÿ±€åŸÅ€å⁄©€åÿ¥ŸÜ"},
verb: {w: "ask for", fa: "ÿØÿ±ÿÆŸàÿßÿ≥ÿ™ ⁄©ÿ±ÿØŸÜ", pr: "ÿßÿ≥⁄© ŸÅŸàÿ±"},
chunk: "ask for clarification",
chunkFa: "ÿØÿ±ÿÆŸàÿßÿ≥ÿ™ ÿ™Ÿàÿ∂€åÿ≠ ÿ®€åÿ¥ÿ™ÿ±"
},

{
noun: {w: "survey", fa: "ŸÜÿ∏ÿ±ÿ≥ŸÜÿ¨€å", pr: "ÿ≥Ÿêÿ±Ÿà€å"},
verb: {w: "fill out", fa: "Ÿæÿ± ⁄©ÿ±ÿØŸÜ", pr: "ŸÅ€åŸÑ ÿ¢Ÿàÿ™"},
chunk: "fill out a survey",
chunkFa: "Ÿæÿ± ⁄©ÿ±ÿØŸÜ ŸÜÿ∏ÿ±ÿ≥ŸÜÿ¨€å"
},

{
noun: {w: "manual", fa: "ÿ±ÿßŸáŸÜŸÖÿß", pr: "ŸÖŸÜ€åŸàÿßŸÑ"},
verb: {w: "read", fa: "ÿÆŸàÿßŸÜÿØŸÜ", pr: "ÿ±€åÿØ"},
chunk: "read a manual",
chunkFa: "ÿÆŸàÿßŸÜÿØŸÜ ÿ±ÿßŸáŸÜŸÖÿß"
},

{
noun: {w: "module", fa: "ŸÖÿß⁄òŸàŸÑ", pr: "ŸÖÿßÿ¨ŸàŸÑ"},
verb: {w: "complete", fa: "⁄©ÿßŸÖŸÑ ⁄©ÿ±ÿØŸÜ", pr: "⁄©ÿßŸÖŸæŸÑ€åÿ™"},
chunk: "complete a module",
chunkFa: "ÿ™⁄©ŸÖ€åŸÑ ŸÖÿß⁄òŸàŸÑ"
},

{
noun: {w: "skills", fa: "ŸÖŸáÿßÿ±ÿ™‚ÄåŸáÿß", pr: "ÿßÿ≥⁄©€åŸÑÿ≤"},
verb: {w: "practice", fa: "ÿ™ŸÖÿ±€åŸÜ ⁄©ÿ±ÿØŸÜ", pr: "Ÿæÿ±⁄©ÿ™€åÿ≥"},
chunk: "practice skills",
chunkFa: "ÿ™ŸÖÿ±€åŸÜ ŸÖŸáÿßÿ±ÿ™‚ÄåŸáÿß"
},

{
noun: {w: "assignment", fa: "ÿ™⁄©ŸÑ€åŸÅ", pr: "ÿßÿ≥ÿß€åŸÜŸÖŸÜÿ™"},
verb: {w: "work on", fa: "⁄©ÿßÿ± ⁄©ÿ±ÿØŸÜ ÿ±Ÿà€å", pr: "Ÿàÿ±⁄© ÿ¢ŸÜ"},
chunk: "work on an assignment",
chunkFa: "⁄©ÿßÿ± ÿ±Ÿà€å ÿ™⁄©ŸÑ€åŸÅ"
},

{
noun: {w: "findings", fa: "€åÿßŸÅÿ™Ÿá‚ÄåŸáÿß", pr: "ŸÅÿß€åŸÜÿØ€åŸÜ⁄Øÿ≤"},
verb: {w: "present", fa: "ÿßÿ±ÿßÿ¶Ÿá ÿØÿßÿØŸÜ", pr: "Ÿæÿ±ÿ≤ŸÜÿ™"},
chunk: "present findings",
chunkFa: "ÿßÿ±ÿßÿ¶Ÿá ŸÜÿ™ÿß€åÿ¨"
},

  ],

  stages: ["noun", "verb", "chunk"],

  score: {
    noun: 1,
    verb: 1,
    chunk: 2
  }
};

/* ================= GAME CLASS ================= */
class Game{
  constructor(){
    this.index=0;
    this.phase=0;
    this.selected=[];
    this.checked=false;
    this.score=0;

    this.el={
      stage:document.getElementById("stage"),
      word:document.getElementById("targetWord"),
      answer:document.getElementById("answerBox"),
      letters:document.getElementById("lettersBox"),
      info:document.getElementById("info"),
      next:document.getElementById("nextBtn"),
      score:document.getElementById("score"),
      progress:document.getElementById("progressBar"),
      overlay:document.getElementById("resultOverlay"),
      rIcon:document.getElementById("resultIcon"),
      rTitle:document.getElementById("resultTitle"),
      rDetail:document.getElementById("resultDetail"),
      rScore:document.getElementById("resultScore")
    };

    this.load();
  }

  shuffle(a){ return a.sort(()=>Math.random()-0.5); }

  updateProgress(){
    const total=data.pairs.length * 3;
    const step=this.index*3 + this.phase + (this.checked?1:0);
    this.el.progress.style.width=(step/total)*100+"%";
  }

  load(){
    this.selected=[];
    this.checked=false;
    this.el.answer.innerHTML="";
    this.el.letters.innerHTML="";
    this.el.info.innerHTML="";
    this.el.next.classList.remove("active");
    this.updateProgress();

    if(this.index>=data.pairs.length){
      document.querySelector(".container").innerHTML=
      `<h2>Game Finished</h2>
       <div style="text-align:center;margin-top:20px;font-size:18px">
       Final Score: ${this.score}
       </div>`;
      return;
    }

    const pair=data.pairs[this.index];
    const stageName=data.stages[this.phase];

    const stageInfo={
      noun:{ text:pair.noun.w, type:"ÿßÿ≥ŸÖ", fa:pair.noun.fa, pr:pair.noun.pr },
      verb:{ text:pair.verb.w, type:"ŸÅÿπŸÑ", fa:pair.verb.fa, pr:pair.verb.pr },
      chunk:{ text:pair.chunk, type:"ÿ™ÿ±⁄©€åÿ®", fa:pair.chunkFa, pr:"" }
    }[stageName];

    this.currentStage=stageInfo;
    this.correct=stageInfo.text;

    this.el.stage.innerText=`ŸÖÿ±ÿ≠ŸÑŸá ${this.phase+1} ‚Äî ${stageInfo.type}`;
    this.el.word.innerText=this.correct;

    this.shuffle(this.correct.split("")).forEach(l=>{
      const d=document.createElement("div");
      d.className="letter";
      d.innerText=l;
      d.onclick=()=>this.pick(d,l);
      this.el.letters.appendChild(d);
    });
  }

  pick(el,l){
    if(this.checked) return;
    el.style.opacity="0";
    el.style.pointerEvents="none";
    this.selected.push(l);

    const d=document.createElement("div");
    d.className="letter";
    d.innerText=l;
    d.onclick=()=>{
      if(this.checked) return;
      this.el.answer.removeChild(d);
      const idx=this.selected.indexOf(l);
      if(idx>-1) this.selected.splice(idx,1);
      el.style.opacity="1";
      el.style.pointerEvents="auto";
    };
    this.el.answer.appendChild(d);

    if(this.selected.length === this.correct.length){
      setTimeout(()=>this.check(),200);
    }
  }

  showResultCard(isCorrect, delta){
    const st=this.currentStage;

    this.el.rIcon.textContent = isCorrect ? "‚úÖ" : "‚ùå";
    this.el.rTitle.textContent = isCorrect ? "ÿ¢ŸÅÿ±€åŸÜ! ÿØÿ±ÿ≥ÿ™ ÿ¨Ÿàÿßÿ® ÿØÿßÿØ€å" : "ÿß€åŸÜ €å⁄©€å ÿßÿ¥ÿ™ÿ®ÿßŸá ÿ¥ÿØ";

    let detail=`ŸÖÿπŸÜ€å: ${st.fa}<br>`;
    if(st.pr) detail+=`ÿ™ŸÑŸÅÿ∏: ${st.pr}<br>`;
    detail+=`ŸÜŸàÿπ: ${st.type}`;

    this.el.rDetail.innerHTML=detail;
    this.el.rScore.textContent = (delta>0 ? "+"+delta : delta) + " ÿßŸÖÿ™€åÿßÿ≤";

    this.el.overlay.classList.add("show");
  }

  check(){
    if(this.checked) return;
    const user=this.selected.join("");
    this.checked=true;

    const stageName=data.stages[this.phase];
    let delta=0;

    if(user===this.correct){
      delta=data.score[stageName];
      this.score+=delta;
      this.showResultCard(true, delta);
    }else{
      delta=-1;
      this.score+=delta;
      this.showResultCard(false, delta);
    }

    this.el.score.innerText=this.score;
    this.el.next.classList.add("active");
    this.updateProgress();
  }

  next(){
    this.el.overlay.classList.remove("show");
    this.phase++;
    if(this.phase>2){
      this.phase=0;
      this.index++;
    }
    this.load();
  }
}

/* ================= INIT ================= */
const game=new Game();
document.getElementById("modalNext").onclick=()=>game.next();

/* ================= THEME SWITCH ================= */
const themeBtn=document.getElementById("themeBtn");
const logoToggle=document.getElementById("logoToggle");

function applyTheme(t){
  document.body.className=t;
  localStorage.setItem("theme",t);
  themeBtn.textContent = t==="dark" ? "üåô" : "‚òÄ";
}

applyTheme(localStorage.getItem("theme") || "dark");

function toggleTheme(){
  const t=document.body.classList.contains("dark") ? "light" : "dark";
  applyTheme(t);
}

themeBtn.onclick=toggleTheme;
logoToggle.onclick=toggleTheme;
</script>

</body>
</html>
