<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>English Chunk Cycle Pro ‚Äì Health & Medicine</title>
<link rel="icon" type="image/png" href="https://uploadkon.ir/uploads/855814_261000016643-removebg-preview.png">

<style>
/* ================= ROOT THEMES ================= */
:root{
  --green:#91c300;
  --red:#ff4b5c;
  --dark-bg:#050711;
  --dark-card:#111522;
  --dark-gray:#2d334a;
  --light-bg:#f5f5f5;
  --light-card:#ffffff;
  --light-gray:#e0e0e0;
  --text-dark:#ffffff;
  --text-light:#000000;
  --shadow:rgba(0,0,0,0.55);
}

*{
  box-sizing:border-box;
  font-family:'Segoe UI',sans-serif;
}

body.dark{
  background:radial-gradient(circle at top,#1b2540,#050711);
  color:var(--text-dark);
}
body.light{
  background:radial-gradient(circle at top,#ffffff,#dcdcdc);
  color:var(--text-light);
}

body{
  margin:0;
  display:flex;
  justify-content:center;
  align-items:center;
  min-height:100vh;
  padding:20px;
  transition:background 0.5s ease, color 0.5s ease;
}

/* ================= TOP BAR ================= */
.top-bar{
  position:absolute;
  top:0;
  left:0;
  width:100%;
  height:90px;
  display:flex;
  justify-content:center;
  align-items:flex-start;
  padding-top:10px;
  z-index:20;
}

/* ÿØ⁄©ŸÖŸáŸî ÿ™ŸÖ ÿØÿ± ⁄ØŸàÿ¥ŸáŸî ÿ®ÿßŸÑÿß ÿ≥ŸÖÿ™ ⁄ÜŸæ */
.theme-btn{
  position:absolute;
  left:15px;
  top:15px;
  width:42px;
  height:42px;
  border:none;
  border-radius:50%;
  cursor:pointer;
  font-size:20px;
  background:rgba(255,255,255,0.15);
  backdrop-filter:blur(6px);
  color:#fff;
  box-shadow:0 4px 12px rgba(0,0,0,0.3);
  transition:0.3s;
}
body.light .theme-btn{
  background:rgba(0,0,0,0.15);
  color:#000;
}
.theme-btn:hover{
  transform:scale(1.12);
}

/* ================= LOGO ================= */
.logo{
  position:absolute;
  top:15px;
  right:15px;
  cursor:pointer;
  z-index:30;
}
.logo img{
  width:130px;
  filter:drop-shadow(0 10px 26px rgba(0,255,118,0.55));
  animation:float 3.5s ease-in-out infinite;
  transition:transform 0.35s ease, filter 0.35s ease;
}
.logo img:hover{
  transform:translateY(-6px) scale(1.06);
  filter:drop-shadow(0 14px 32px rgba(0,255,118,0.85));
}
.logo img:active{
  transform:scale(0.9);
}
@keyframes float{
  0%{transform:translateY(0);}
  50%{transform:translateY(-8px);}
  100%{transform:translateY(0);}
}

/* ================= CONTAINER ================= */
.container{
  width:100%;
  max-width:520px;
  background:var(--dark-card);
  border-radius:22px;
  padding:110px 30px 30px 30px;
  box-shadow:0 18px 45px var(--shadow);
  position:relative;
  overflow:hidden;
  transition:background 0.5s ease, box-shadow 0.5s ease, transform 0.3s ease;
}
body.light .container{
  background:var(--light-card);
}
.container:hover{
  transform:translateY(-3px);
}

/* ================= UI ================= */
h2{
  text-align:center;
  margin-bottom:8px;
  font-weight:650;
}

.progress-container{
  width:100%;
  height:10px;
  background:rgba(255,255,255,0.08);
  border-radius:999px;
  overflow:hidden;
  margin-bottom:15px;
}
.progress-bar{
  height:100%;
  width:0%;
  background:linear-gradient(90deg,#91c300,#00ffb3);
  transition:width 0.4s ease;
}

.stage{
  text-align:center;
  opacity:.8;
  margin-bottom:12px;
  font-size:14px;
}

.word{
  text-align:center;
  font-size:26px;
  letter-spacing:3px;
  margin:12px 0;
  color:var(--green);
  text-shadow:0 0 10px rgba(0,255,118,0.6);
}

/* ================= ANSWER & LETTERS ================= */
.answer-box{
  min-height:60px;
  border:2px dashed rgba(255,255,255,0.12);
  border-radius:16px;
  display:flex;
  flex-wrap:wrap;
  justify-content:center;
  align-items:center;
  gap:10px;
  margin:18px 0;
  padding:12px;
  background:rgba(0,0,0,0.25);
  backdrop-filter:blur(10px);
}
body.light .answer-box{
  border-color:rgba(0,0,0,0.12);
  background:rgba(255,255,255,0.6);
}

.letters{
  display:flex;
  flex-wrap:wrap;
  justify-content:center;
  gap:12px;
  margin-bottom:12px;
}

.letter{
  background:var(--dark-gray);
  padding:12px 16px;
  border-radius:14px;
  cursor:pointer;
  user-select:none;
  transition:all 0.25s ease;
  font-size:18px;
  box-shadow:0 4px 14px rgba(0,0,0,0.4);
}
body.light .letter{
  background:var(--light-gray);
}
.letter:hover{
  transform:scale(1.12) translateY(-2px);
  background:var(--green);
  color:#000;
}

/* ================= NEXT BUTTON ================= */
.next-btn{
  width:100%;
  margin-top:12px;
  padding:14px;
  border:none;
  border-radius:14px;
  font-size:16px;
  font-weight:600;
  cursor:pointer;
  background:#444;
  color:#aaa;
  cursor:not-allowed;
  transition:0.3s;
}
.next-btn.active{
  background:linear-gradient(90deg,#91c300,#00ffb3);
  color:#000;
  cursor:pointer;
}

/* ================= RESULT MODAL ================= */
.result-overlay{
  position:fixed;
  inset:0;
  display:flex;
  justify-content:center;
  align-items:center;
  background:rgba(0,0,0,0.45);
  backdrop-filter:blur(4px);
  opacity:0;
  pointer-events:none;
  transition:opacity 0.3s ease;
  z-index:50;
}
.result-overlay.show{
  opacity:1;
  pointer-events:auto;
}

.result-card{
  width:90%;
  max-width:360px;
  border-radius:20px;
  padding:22px;
  background:rgba(15,18,30,0.92);
  color:#fff;
  box-shadow:0 18px 40px rgba(0,0,0,0.7);
  transform:scale(0.85) translateY(20px);
  opacity:0;
  transition:transform 0.35s ease, opacity 0.35s ease;
}
body.light .result-card{
  background:rgba(255,255,255,0.96);
  color:#000;
}
.result-overlay.show .result-card{
  transform:scale(1) translateY(0);
  opacity:1;
}

.result-icon{
  font-size:40px;
  text-align:center;
  margin-bottom:10px;
}
.result-title{
  text-align:center;
  font-weight:700;
  margin-bottom:10px;
}
.result-detail{
  font-size:15px;
  line-height:1.7;
  margin-top:6px;
  text-align:center;
}
.result-score{
  margin-top:10px;
  font-size:15px;
  font-weight:600;
  text-align:center;
  color:var(--green);
}

.modal-next{
  margin-top:18px;
  width:100%;
  padding:12px;
  border:none;
  border-radius:12px;
  background:linear-gradient(90deg,#91c300,#00ffb3);
  font-size:16px;
  font-weight:600;
  cursor:pointer;
  color:#000;
}

/* ================= RESPONSIVE ================= */
@media(max-width:500px){
  .container{padding:120px 20px 25px 20px;}
  .word{font-size:22px;}
  .letter{padding:10px 14px;font-size:16px;}
}
</style>
</head>

<body class="dark">

<!-- TOP BAR -->
<div class="top-bar">
  <button class="theme-btn" id="themeBtn">üåô</button>

  <div class="logo" id="logoToggle">
    <img src="https://uploadkon.ir/uploads/855814_261000016643-removebg-preview.png">
  </div>
</div>

<div class="container">

  <h2>Health & Medicine Phrases</h2>

  <div class="progress-container">
    <div class="progress-bar" id="progressBar"></div>
  </div>

  <div class="stage" id="stage"></div>
  <div class="word" id="targetWord"></div>

  <div class="answer-box" id="answerBox"></div>
  <div class="letters" id="lettersBox"></div>

  <button class="next-btn" id="nextBtn">Continue</button>

  <div class="info" id="info"></div>
  <div class="score">Score: <span id="score">0</span></div>

</div>

<!-- RESULT MODAL -->
<div class="result-overlay" id="resultOverlay">
  <div class="result-card">
    <div class="result-icon" id="resultIcon">‚ùå</div>
    <div class="result-title" id="resultTitle">ŸÜÿ™€åÿ¨Ÿá</div>
    <div class="result-detail" id="resultDetail"></div>
    <div class="result-score" id="resultScore"></div>
    <button class="modal-next" id="modalNext">Next</button>
  </div>
</div>

<script>
/* ================= DATA ================= */
const data = {
  pairs: [
    // üß† Ÿæÿß€åŸá‚Äåÿ™ÿ±€åŸÜ‚ÄåŸáÿß
    {
      noun: {w: "headache", fa: "ÿ≥ÿ±ÿØÿ±ÿØ", pr: "ŸáŸêÿØŸê€å⁄©"},
      verb: {w: "have", fa: "ÿØÿßÿ¥ÿ™ŸÜ", pr: "ŸáÿßŸà"},
      chunk: "have a headache",
      chunkFa: "ÿ≥ÿ±ÿØÿ±ÿØ ÿØÿßÿ¥ÿ™ŸÜ"
    },
    {
      noun: {w: "cold", fa: "ÿ≥ÿ±ŸÖÿß", pr: "⁄©ŸèŸÑÿØ"},
      verb: {w: "catch", fa: "ÿÆŸàÿ±ÿØŸÜ", pr: "⁄©Ÿé⁄Ü"},
      chunk: "catch a cold",
      chunkFa: "ÿ≥ÿ±ŸÖÿß ÿÆŸàÿ±ÿØŸÜ"
    },
    {
      noun: {w: "sick", fa: "ŸÖÿ±€åÿ∂", pr: "ÿ≥€å⁄©"},
      verb: {w: "get", fa: "ÿ¥ÿØŸÜ", pr: "⁄ØŸêÿ™"},
      chunk: "get sick",
      chunkFa: "ŸÖÿ±€åÿ∂ ÿ¥ÿØŸÜ"
    },
    {
      noun: {w: "pain", fa: "ÿØÿ±ÿØ", pr: "ŸæŸê€åŸÜ"},
      verb: {w: "feel", fa: "ÿßÿ≠ÿ≥ÿßÿ≥ ⁄©ÿ±ÿØŸÜ", pr: "ŸÅ€åŸÑ"},
      chunk: "feel pain",
      chunkFa: "ÿßÿ≠ÿ≥ÿßÿ≥ ÿØÿ±ÿØ ÿØÿßÿ¥ÿ™ŸÜ"
    },
    {
      noun: {w: "fever", fa: "ÿ™ÿ®", pr: "ŸÅŸê€åŸàŸêÿ±"},
      verb: {w: "have", fa: "ÿØÿßÿ¥ÿ™ŸÜ", pr: "ŸáÿßŸà"},
      chunk: "have a fever",
      chunkFa: "ÿ™ÿ® ÿØÿßÿ¥ÿ™ŸÜ"
    },
    {
      noun: {w: "medicine", fa: "ÿØÿßÿ±Ÿà", pr: "ŸÖŸêÿØÿ≥ŸêŸÜ"},
      verb: {w: "take", fa: "ÿÆŸàÿ±ÿØŸÜ", pr: "ÿ™Ÿê€å⁄©"},
      chunk: "take medicine",
      chunkFa: "ÿØÿßÿ±Ÿà ÿÆŸàÿ±ÿØŸÜ"
    },
    {
      noun: {w: "doctor", fa: "ÿØ⁄©ÿ™ÿ±", pr: "ÿØÿß⁄©ÿ™Ÿéÿ±"},
      verb: {w: "see", fa: "ÿ±ŸÅÿ™ŸÜ ÿ®Ÿá", pr: "ÿ≥€å"},
      chunk: "see a doctor",
      chunkFa: "ÿØ⁄©ÿ™ÿ± ÿ±ŸÅÿ™ŸÜ"
    },
    {
      noun: {w: "doctor", fa: "ÿØ⁄©ÿ™ÿ±", pr: "ÿØÿß⁄©ÿ™Ÿéÿ±"},
      verb: {w: "visit", fa: "ŸÖÿ±ÿßÿ¨ÿπŸá ⁄©ÿ±ÿØŸÜ ÿ®Ÿá", pr: "Ÿà€åÿ≤€åÿ™"},
      chunk: "visit a doctor",
      chunkFa: "ŸÖÿ±ÿßÿ¨ÿπŸá ÿ®Ÿá ÿØ⁄©ÿ™ÿ±"
    },
    {
      noun: {w: "blood pressure", fa: "ŸÅÿ¥ÿßÿ± ÿÆŸàŸÜ", pr: "ÿ®ŸÑŸéÿØ ŸæŸêÿ±Ÿêÿ¥ÿ±"},
      verb: {w: "check", fa: "⁄Ü⁄© ⁄©ÿ±ÿØŸÜ", pr: "⁄ÜŸê⁄©"},
      chunk: "check blood pressure",
      chunkFa: "ŸÅÿ¥ÿßÿ± ÿÆŸàŸÜ ⁄Ü⁄© ⁄©ÿ±ÿØŸÜ"
    },
    {
      noun: {w: "temperature", fa: "ÿØŸÖÿß", pr: "ÿ™ŸêŸÖŸæŸêÿ±⁄ÜŸêÿ±"},
      verb: {w: "measure", fa: "ÿßŸÜÿØÿßÿ≤Ÿá‚Äå⁄Ø€åÿ±€å ⁄©ÿ±ÿØŸÜ", pr: "ŸÖŸê⁄òŸêÿ±"},
      chunk: "measure temperature",
      chunkFa: "ÿßŸÜÿØÿßÿ≤Ÿá‚Äå⁄Ø€åÿ±€å ÿØŸÖÿß"
    },
    // üíä ÿØÿ±ŸÖÿßŸÜ Ÿà Ÿæÿ≤ÿ¥⁄©€å
    {
      noun: {w: "pill", fa: "ŸÇÿ±ÿµ", pr: "Ÿæ€åŸÑ"},
      verb: {w: "take", fa: "ÿÆŸàÿ±ÿØŸÜ", pr: "ÿ™Ÿê€å⁄©"},
      chunk: "take a pill",
      chunkFa: "ŸÇÿ±ÿµ ÿÆŸàÿ±ÿØŸÜ"
    },
    {
      noun: {w: "treatment", fa: "ÿØÿ±ŸÖÿßŸÜ", pr: "ÿ™ÿ±€åÿ™‚ÄåŸÖŸêŸÜÿ™"},
      verb: {w: "get", fa: "⁄Øÿ±ŸÅÿ™ŸÜ", pr: "⁄ØŸêÿ™"},
      chunk: "get treatment",
      chunkFa: "ÿØÿ±ŸÖÿßŸÜ ⁄Øÿ±ŸÅÿ™ŸÜ"
    },
    {
      noun: {w: "treatment", fa: "ÿØÿ±ŸÖÿßŸÜ", pr: "ÿ™ÿ±€åÿ™‚ÄåŸÖŸêŸÜÿ™"},
      verb: {w: "receive", fa: "ÿØÿ±€åÿßŸÅÿ™ ⁄©ÿ±ÿØŸÜ", pr: "ÿ±€å‚Äåÿ≥€åŸà"},
      chunk: "receive treatment",
      chunkFa: "ÿØÿ±ŸÖÿßŸÜ ÿØÿ±€åÿßŸÅÿ™ ⁄©ÿ±ÿØŸÜ"
    },
    {
      noun: {w: "treatment", fa: "ÿØÿ±ŸÖÿßŸÜ", pr: "ÿ™ÿ±€åÿ™‚ÄåŸÖŸêŸÜÿ™"},
      verb: {w: "give", fa: "ÿØÿßÿØŸÜ", pr: "⁄Ø€åŸà"},
      chunk: "give treatment",
      chunkFa: "ÿØÿ±ŸÖÿßŸÜ ÿØÿßÿØŸÜ"
    },
    {
      noun: {w: "medicine", fa: "ÿØÿßÿ±Ÿà", pr: "ŸÖŸêÿØÿ≥ŸêŸÜ"},
      verb: {w: "prescribe", fa: "ÿ™ÿ¨Ÿà€åÿ≤ ⁄©ÿ±ÿØŸÜ", pr: "Ÿæÿ±€åÿ≥⁄©ÿ±ÿß€åÿ®"},
      chunk: "prescribe medicine",
      chunkFa: "ÿØÿßÿ±Ÿà ÿ™ÿ¨Ÿà€åÿ≤ ⁄©ÿ±ÿØŸÜ"
    },
    {
      noun: {w: "treatment", fa: "ÿØÿ±ŸÖÿßŸÜ", pr: "ÿ™ÿ±€åÿ™‚ÄåŸÖŸêŸÜÿ™"},
      verb: {w: "follow", fa: "ÿØŸÜÿ®ÿßŸÑ ⁄©ÿ±ÿØŸÜ", pr: "ŸÅÿßŸÑŸà"},
      chunk: "follow a treatment",
      chunkFa: "ÿØÿ±ŸÖÿßŸÜ ÿ±ÿß ÿØŸÜÿ®ÿßŸÑ ⁄©ÿ±ÿØŸÜ"
    },
    {
      noun: {w: "disease", fa: "ÿ®€åŸÖÿßÿ±€å", pr: "ÿØ€å‚Äåÿ≤€åÿ≤"},
      verb: {w: "treat", fa: "ÿØÿ±ŸÖÿßŸÜ ⁄©ÿ±ÿØŸÜ", pr: "ÿ™ÿ±€åÿ™"},
      chunk: "treat a disease",
      chunkFa: "ÿØÿ±ŸÖÿßŸÜ ÿ®€åŸÖÿßÿ±€å"
    },
    {
      noun: {w: "illness", fa: "ÿ®€åŸÖÿßÿ±€å", pr: "ÿß€åŸÑ‚ÄåŸÜŸêÿ≥"},
      verb: {w: "cure", fa: "⁄©ÿßŸÖŸÑÿßŸã ÿØÿ±ŸÖÿßŸÜ ⁄©ÿ±ÿØŸÜ", pr: "⁄©€åŸàÿ±"},
      chunk: "cure an illness",
      chunkFa: "ÿØÿ±ŸÖÿßŸÜ ⁄©ÿßŸÖŸÑ ÿ®€åŸÖÿßÿ±€å"
    },
    {
      noun: {w: "pain", fa: "ÿØÿ±ÿØ", pr: "ŸæŸê€åŸÜ"},
      verb: {w: "relieve", fa: "⁄©ÿßŸáÿ¥ ÿØÿßÿØŸÜ", pr: "ÿ±€å‚ÄåŸÑ€åŸà"},
      chunk: "relieve pain",
      chunkFa: "⁄©ÿßŸáÿ¥ ÿØÿ±ÿØ"
    },
    {
      noun: {w: "fever", fa: "ÿ™ÿ®", pr: "ŸÅŸê€åŸàŸêÿ±"},
      verb: {w: "reduce", fa: "⁄©ÿßŸáÿ¥ ÿØÿßÿØŸÜ", pr: "ÿ±€å‚ÄåÿØŸàÿ≥"},
      chunk: "reduce fever",
      chunkFa: "⁄©ÿßŸáÿ¥ ÿ™ÿ®"
    },
    // üè• ŸÖÿ±ÿßÿ¨ÿπŸá Ÿà ŸÖÿπÿß€åŸÜŸá
    {
      noun: {w: "appointment", fa: "ŸàŸÇÿ™", pr: "ÿßŸêŸæŸà€åŸÜÿ™‚ÄåŸÖŸêŸÜÿ™"},
      verb: {w: "make", fa: "⁄Øÿ±ŸÅÿ™ŸÜ", pr: "ŸÖŸê€å⁄©"},
      chunk: "make an appointment",
      chunkFa: "ŸàŸÇÿ™ ⁄Øÿ±ŸÅÿ™ŸÜ"
    },
    {
      noun: {w: "appointment", fa: "ŸàŸÇÿ™", pr: "ÿßŸêŸæŸà€åŸÜÿ™‚ÄåŸÖŸêŸÜÿ™"},
      verb: {w: "miss", fa: "ÿßÿ≤ ÿØÿ≥ÿ™ ÿØÿßÿØŸÜ", pr: "ŸÖ€åÿ≥"},
      chunk: "miss an appointment",
      chunkFa: "ŸàŸÇÿ™ ÿ±ÿß ÿßÿ≤ ÿØÿ≥ÿ™ ÿØÿßÿØŸÜ"
    },
    {
      noun: {w: "appointment", fa: "ŸàŸÇÿ™", pr: "ÿßŸêŸæŸà€åŸÜÿ™‚ÄåŸÖŸêŸÜÿ™"},
      verb: {w: "cancel", fa: "ŸÑÿ∫Ÿà ⁄©ÿ±ÿØŸÜ", pr: "⁄©ŸéŸÜÿ≥ŸêŸÑ"},
      chunk: "cancel an appointment",
      chunkFa: "ŸÑÿ∫Ÿà ŸàŸÇÿ™"
    },
    {
      noun: {w: "check-up", fa: "⁄Ü⁄©ÿßŸæ", pr: "⁄Ü⁄© ÿ¢Ÿæ"},
      verb: {w: "do", fa: "ÿßŸÜÿ¨ÿßŸÖ ÿØÿßÿØŸÜ", pr: "ÿØŸà"},
      chunk: "do a check-up",
      chunkFa: "⁄Ü⁄©ÿßŸæ ÿßŸÜÿ¨ÿßŸÖ ÿØÿßÿØŸÜ"
    },
    {
      noun: {w: "tests", fa: "ÿ¢ÿ≤ŸÖÿß€åÿ¥‚ÄåŸáÿß", pr: "ÿ™Ÿêÿ≥ÿ™ÿ≥"},
      verb: {w: "run", fa: "⁄Øÿ±ŸÅÿ™ŸÜ", pr: "ÿ±ÿßŸÜ"},
      chunk: "run tests",
      chunkFa: "ÿ¢ÿ≤ŸÖÿß€åÿ¥ ⁄Øÿ±ŸÅÿ™ŸÜ"
    },
    {
      noun: {w: "test", fa: "ÿ¢ÿ≤ŸÖÿß€åÿ¥", pr: "ÿ™Ÿêÿ≥ÿ™"},
      verb: {w: "take", fa: "ÿØÿßÿØŸÜ", pr: "ÿ™Ÿê€å⁄©"},
      chunk: "take a test",
      chunkFa: "ÿ¢ÿ≤ŸÖÿß€åÿ¥ ÿØÿßÿØŸÜ"
    },
    {
      noun: {w: "heart", fa: "ŸÇŸÑÿ®", pr: "Ÿáÿßÿ±ÿ™"},
      verb: {w: "check", fa: "ÿ®ÿ±ÿ±ÿ≥€å ⁄©ÿ±ÿØŸÜ", pr: "⁄ÜŸê⁄©"},
      chunk: "check the heart",
      chunkFa: "ÿ®ÿ±ÿ±ÿ≥€å ŸÇŸÑÿ®"
    },
    {
      noun: {w: "patient", fa: "ÿ®€åŸÖÿßÿ±", pr: "ŸæŸê€åÿ¥ŸêŸÜÿ™"},
      verb: {w: "examine", fa: "ŸÖÿπÿß€åŸÜŸá ⁄©ÿ±ÿØŸÜ", pr: "ÿßŸê⁄Øÿ≤ŸéŸÖ€åŸÜ"},
      chunk: "examine a patient",
      chunkFa: "ŸÖÿπÿß€åŸÜŸá ÿ®€åŸÖÿßÿ±"
    },
    {
      noun: {w: "problem", fa: "ŸÖÿ¥⁄©ŸÑ", pr: "Ÿæÿ±ÿßÿ®ŸÑŸÖ"},
      verb: {w: "diagnose", fa: "ÿ™ÿ¥ÿÆ€åÿµ ÿØÿßÿØŸÜ", pr: "ÿØÿß€åŸé⁄ØŸÜŸàÿ≤"},
      chunk: "diagnose a problem",
      chunkFa: "ÿ™ÿ¥ÿÆ€åÿµ ŸÖÿ¥⁄©ŸÑ"
    },
    {
      noun: {w: "disease", fa: "ÿ®€åŸÖÿßÿ±€å", pr: "ÿØ€å‚Äåÿ≤€åÿ≤"},
      verb: {w: "detect", fa: "ÿ™ÿ¥ÿÆ€åÿµ ÿØÿßÿØŸÜ", pr: "ÿØ€å‚Äåÿ™Ÿê⁄©ÿ™"},
      chunk: "detect a disease",
      chunkFa: "ÿ™ÿ¥ÿÆ€åÿµ ÿ®€åŸÖÿßÿ±€å"
    },
    // ü¶¥ ÿ®ÿØŸÜ Ÿà ÿπŸÖŸÑ⁄©ÿ±ÿØ
    {
      noun: {w: "bone", fa: "ÿßÿ≥ÿ™ÿÆŸàÿßŸÜ", pr: "ÿ®ŸàŸÜ"},
      verb: {w: "break", fa: "ÿ¥⁄©ÿ≥ÿ™ŸÜ", pr: "ÿ®ÿ±€å⁄©"},
      chunk: "break a bone",
      chunkFa: "ÿ¥⁄©ÿ≥ÿ™ŸÜ ÿßÿ≥ÿ™ÿÆŸàÿßŸÜ"
    },
    {
      noun: {w: "back", fa: "⁄©ŸÖÿ±", pr: "ÿ®⁄©"},
      verb: {w: "hurt", fa: "ÿ¢ÿ≥€åÿ® ÿ≤ÿØŸÜ ÿ®Ÿá", pr: "ŸáŸèÿ±ÿ™"},
      chunk: "hurt your back",
      chunkFa: "ÿ¢ÿ≥€åÿ® ÿ®Ÿá ⁄©ŸÖÿ±"
    },
    {
      noun: {w: "muscle", fa: "ÿπÿ∂ŸÑŸá", pr: "ŸÖÿßÿ≥ŸêŸÑ"},
      verb: {w: "damage", fa: "ÿ¢ÿ≥€åÿ® ÿ≤ÿØŸÜ ÿ®Ÿá", pr: "ÿØŸéŸÖŸêÿ¨"},
      chunk: "damage a muscle",
      chunkFa: "ÿ¢ÿ≥€åÿ® ÿ®Ÿá ÿπÿ∂ŸÑŸá"
    },
    {
      noun: {w: "muscle", fa: "ÿπÿ∂ŸÑŸá", pr: "ŸÖÿßÿ≥ŸêŸÑ"},
      verb: {w: "stretch", fa: "⁄©ÿ¥ ÿ¢ŸÖÿØŸÜ", pr: "ÿßŸêÿ≥ÿ™ÿ±⁄Ü"},
      chunk: "stretch a muscle",
      chunkFa: "⁄©ÿ¥ ÿ¢ŸÖÿØŸÜ ÿπÿ∂ŸÑŸá"
    },
    {
      noun: {w: "muscle", fa: "ÿπÿ∂ŸÑŸá", pr: "ŸÖÿßÿ≥ŸêŸÑ"},
      verb: {w: "pull", fa: "⁄©ÿ¥€åÿØ⁄Ø€å", pr: "ŸæŸàŸÑ"},
      chunk: "pull a muscle",
      chunkFa: "⁄©ÿ¥€åÿØ⁄Ø€å ÿπÿ∂ŸÑŸá"
    },
    {
      noun: {w: "weight", fa: "Ÿàÿ≤ŸÜ", pr: "ŸàŸê€åÿ™"},
      verb: {w: "lose", fa: "⁄©ÿßŸáÿ¥ ÿØÿßÿØŸÜ", pr: "ŸÑŸàÿ≤"},
      chunk: "lose weight",
      chunkFa: "⁄©ÿßŸáÿ¥ Ÿàÿ≤ŸÜ"
    },
    {
      noun: {w: "weight", fa: "Ÿàÿ≤ŸÜ", pr: "ŸàŸê€åÿ™"},
      verb: {w: "gain", fa: "ÿßŸÅÿ≤ÿß€åÿ¥ ÿØÿßÿØŸÜ", pr: "⁄ØŸê€åŸÜ"},
      chunk: "gain weight",
      chunkFa: "ÿßŸÅÿ≤ÿß€åÿ¥ Ÿàÿ≤ŸÜ"
    },
    {
      noun: {w: "muscle", fa: "ÿπÿ∂ŸÑŸá", pr: "ŸÖÿßÿ≥ŸêŸÑ"},
      verb: {w: "build", fa: "ÿ≥ÿßÿÆÿ™ŸÜ", pr: "ÿ®€åŸÑÿØ"},
      chunk: "build muscle",
      chunkFa: "ÿπÿ∂ŸÑŸá ÿ≥ÿßÿÆÿ™ŸÜ"
    },
    {
      noun: {w: "strength", fa: "ŸÇÿØÿ±ÿ™", pr: "ÿßŸêÿ≥ÿ™ÿ±ŸêŸÜ⁄Øÿ´"},
      verb: {w: "improve", fa: "ÿßŸÅÿ≤ÿß€åÿ¥ ÿØÿßÿØŸÜ", pr: "ÿß€åŸÖ‚ÄåŸæÿ±ŸàŸà"},
      chunk: "improve strength",
      chunkFa: "ÿßŸÅÿ≤ÿß€åÿ¥ ŸÇÿØÿ±ÿ™"
    },
    {
      noun: {w: "energy", fa: "ÿßŸÜÿ±⁄ò€å", pr: "ÿßŸêŸÜŸêÿ±ÿ¨€å"},
      verb: {w: "increase", fa: "ÿßŸÅÿ≤ÿß€åÿ¥ ÿØÿßÿØŸÜ", pr: "ÿß€åŸÜ‚Äå⁄©ÿ±€åÿ≥"},
      chunk: "increase energy",
      chunkFa: "ÿßŸÅÿ≤ÿß€åÿ¥ ÿßŸÜÿ±⁄ò€å"
    }
  ],

  stages: ["noun", "verb", "chunk"],

  score: {
    noun: 1,
    verb: 1,
    chunk: 2
  }
};

/* ================= GAME CLASS ================= */
class Game{
  constructor(){
    this.index=0;
    this.phase=0;
    this.selected=[];
    this.checked=false;
    this.score=0;

    this.el={
      stage:document.getElementById("stage"),
      word:document.getElementById("targetWord"),
      answer:document.getElementById("answerBox"),
      letters:document.getElementById("lettersBox"),
      info:document.getElementById("info"),
      next:document.getElementById("nextBtn"),
      score:document.getElementById("score"),
      progress:document.getElementById("progressBar"),
      overlay:document.getElementById("resultOverlay"),
      rIcon:document.getElementById("resultIcon"),
      rTitle:document.getElementById("resultTitle"),
      rDetail:document.getElementById("resultDetail"),
      rScore:document.getElementById("resultScore")
    };

    this.load();
  }

  shuffle(a){ return a.sort(()=>Math.random()-0.5); }

  updateProgress(){
    const total=data.pairs.length * 3;
    const step=this.index*3 + this.phase + (this.checked?1:0);
    this.el.progress.style.width=(step/total)*100+"%";
  }

  load(){
    this.selected=[];
    this.checked=false;
    this.el.answer.innerHTML="";
    this.el.letters.innerHTML="";
    this.el.info.innerHTML="";
    this.el.next.classList.remove("active");
    this.updateProgress();

    if(this.index>=data.pairs.length){
      document.querySelector(".container").innerHTML=
      `<h2>Game Finished</h2>
       <div style="text-align:center;margin-top:20px;font-size:18px">
       Final Score: ${this.score}
       </div>`;
      return;
    }

    const pair=data.pairs[this.index];
    const stageName=data.stages[this.phase];

    const stageInfo={
      noun:{ text:pair.noun.w, type:"ÿßÿ≥ŸÖ", fa:pair.noun.fa, pr:pair.noun.pr },
      verb:{ text:pair.verb.w, type:"ŸÅÿπŸÑ", fa:pair.verb.fa, pr:pair.verb.pr },
      chunk:{ text:pair.chunk, type:"ÿ™ÿ±⁄©€åÿ®", fa:pair.chunkFa, pr:"" }
    }[stageName];

    this.currentStage=stageInfo;
    this.correct=stageInfo.text;

    this.el.stage.innerText=`ŸÖÿ±ÿ≠ŸÑŸá ${this.phase+1} ‚Äî ${stageInfo.type}`;
    this.el.word.innerText=this.correct;

    this.shuffle(this.correct.split("")).forEach(l=>{
      const d=document.createElement("div");
      d.className="letter";
      d.innerText=l;
      d.onclick=()=>this.pick(d,l);
      this.el.letters.appendChild(d);
    });
  }

  pick(el,l){
    if(this.checked) return;
    el.style.opacity="0";
    el.style.pointerEvents="none";
    this.selected.push(l);

    const d=document.createElement("div");
    d.className="letter";
    d.innerText=l;
    d.onclick=()=>{
      if(this.checked) return;
      this.el.answer.removeChild(d);
      const idx=this.selected.indexOf(l);
      if(idx>-1) this.selected.splice(idx,1);
      el.style.opacity="1";
      el.style.pointerEvents="auto";
    };
    this.el.answer.appendChild(d);

    if(this.selected.length === this.correct.length){
      setTimeout(()=>this.check(),200);
    }
  }

  showResultCard(isCorrect, delta){
    const st=this.currentStage;

    this.el.rIcon.textContent = isCorrect ? "‚úÖ" : "‚ùå";
    this.el.rTitle.textContent = isCorrect ? "ÿ¢ŸÅÿ±€åŸÜ! ÿØÿ±ÿ≥ÿ™ ÿ¨Ÿàÿßÿ® ÿØÿßÿØ€å" : "ÿß€åŸÜ €å⁄©€å ÿßÿ¥ÿ™ÿ®ÿßŸá ÿ¥ÿØ";

    let detail=`ŸÖÿπŸÜ€å: ${st.fa}<br>`;
    if(st.pr) detail+=`ÿ™ŸÑŸÅÿ∏: ${st.pr}<br>`;
    detail+=`ŸÜŸàÿπ: ${st.type}`;

    this.el.rDetail.innerHTML=detail;
    this.el.rScore.textContent = (delta>0 ? "+"+delta : delta) + " ÿßŸÖÿ™€åÿßÿ≤";

    this.el.overlay.classList.add("show");
  }

  check(){
    if(this.checked) return;
    const user=this.selected.join("");
    this.checked=true;

    const stageName=data.stages[this.phase];
    let delta=0;

    if(user===this.correct){
      delta=data.score[stageName];
      this.score+=delta;
      this.showResultCard(true, delta);
    }else{
      delta=-1;
      this.score+=delta;
      this.showResultCard(false, delta);
    }

    this.el.score.innerText=this.score;
    this.el.next.classList.add("active");
    this.updateProgress();
  }

  next(){
    this.el.overlay.classList.remove("show");
    this.phase++;
    if(this.phase>2){
      this.phase=0;
      this.index++;
    }
    this.load();
  }
}

/* ================= INIT ================= */
const game=new Game();
document.getElementById("modalNext").onclick=()=>game.next();

/* ================= THEME SWITCH ================= */
const themeBtn=document.getElementById("themeBtn");
const logoToggle=document.getElementById("logoToggle");

function applyTheme(t){
  document.body.className=t;
  localStorage.setItem("theme",t);
  themeBtn.textContent = t==="dark" ? "üåô" : "‚òÄ";
}

applyTheme(localStorage.getItem("theme") || "dark");

function toggleTheme(){
  const t=document.body.classList.contains("dark") ? "light" : "dark";
  applyTheme(t);
}

themeBtn.onclick=toggleTheme;
logoToggle.onclick=toggleTheme;
</script>

</body>
</html>
